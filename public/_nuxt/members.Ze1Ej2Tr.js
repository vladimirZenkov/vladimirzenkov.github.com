import{_ as p,v as d,x as t,N as c,O as h,Q as r,L as b,R as g,t as i,y as _}from"./entry.qkUUKhXO.js";const v={data(){return{girls:[],teams:[],teamName:""}},mounted(){this.getData(),this.getTeams()},methods:{handleDragStart(l,a){l.dataTransfer.setData("girl",JSON.stringify(a)),console.log("dragStart")},async removeFromTeam(l){await $fetch(`https://api-generator.retool.com/gCsWMZ/girls/${l}/`,{method:"PATCH",body:{team_id:0}}),await this.getData()},async handleDrop(l,a){let s=JSON.parse(l.dataTransfer.getData("girl"));s.team_id=parseInt(a),s.id=parseInt(s.id),await $fetch(`https://api-generator.retool.com/gCsWMZ/girls/${s.id}/`,{method:"PUT",body:s}),await this.getData()},async getTeams(){let l=await $fetch("https://api-generator.retool.com/QAwsSX/teams/",{method:"GET"});this.teams=l},async addTeam(){await $fetch("https://api-generator.retool.com/QAwsSX/teams",{method:"POST",body:{name:this.teamName,round_1:0,round_2:0,round_3:0,round_4:0,round_5:0}}),await this.getTeams(),this.teamName=""},async deleteTeam(l){const a=this.girls.filter(s=>s.team_id===l).map(s=>s.id);for(let s of a)await this.removeFromTeam(s);await $fetch(`https://api-generator.retool.com/QAwsSX/teams/${l}`,{method:"DELETE"}),await this.getTeams()},async updateTeam(l,a){let s=Object.fromEntries([...new FormData(l.target)]);await $fetch(`https://api-generator.retool.com/QAwsSX/teams/${a}`,{method:"PATCH",body:s}),await this.getTeams()},async getData(){let l=await $fetch("https://api-generator.retool.com/gCsWMZ/girls",{method:"GET"});this.girls=l.sort((a,s)=>a.team_id-s.team_id),console.log("resp: ",l)},async deleteGirl(l){await $fetch(`https://api-generator.retool.com/gCsWMZ/girls/${l}`,{method:"DELETE"}),await this.getData()},async incrementCurrentId(){const l=this.currentId;this.currentId=null,await new Promise(a=>setTimeout(a,1300)),this.currentId=l+1}}},f=t("h1",{class:"title"}," Панель редактора ",-1),T={class:"service-tables"},y={class:"service-table service-table_members"},w=t("thead",null,[t("tr",null,[t("th",null,"Имя"),t("th",null,"Команда"),t("th",null,"Слаг"),t("th")])],-1),S=["onDragstart"],D=["onClick"],C={class:"service-table"},k=t("thead",null,[t("tr",null,[t("th",null,"Название команды"),t("th",null,"Участники"),t("th",null,"1 раунд"),t("th",null,"2 раунд"),t("th",null,"3 раунд"),t("th",null,"4 раунд"),t("th",null,"Финал"),t("th")])],-1),E=["onSubmit"],I=["value"],N=["onDrop"],x=["onClick"],A=["onSubmit"],M=["value"],F=["onSubmit"],O=["value"],P=["onSubmit"],Q=["value"],G=["onSubmit"],L=["value"],W=["onSubmit"],X=["value"],Z=["onClick"],B=t("td",null,null,-1),H=t("td",null,null,-1),J=t("td",null,null,-1),U=t("td",null,null,-1),V=t("td",null,null,-1),j=t("td",null,null,-1),R=t("td",null,null,-1);function $(l,a,s,q,u,o){return i(),d("div",null,[f,t("div",T,[t("div",y,[t("table",null,[w,t("tbody",null,[(i(!0),d(c,null,h(u.girls.filter(e=>!e.team_id),e=>{var n;return i(),d("tr",{key:e.id,draggable:"true",onDragstart:m=>o.handleDragStart(m,e)},[t("td",null,[t("div",null,_(e.name),1)]),t("td",null,_((n=u.teams.find(m=>m.id===e.team_id))==null?void 0:n.name),1),t("td",null,_(e.slug),1),t("td",null,[t("button",{class:"delete-btn",onClick:m=>o.deleteGirl(e.id)},"Удалить",8,D)])],40,S)}),128))])])]),t("div",C,[t("table",null,[k,t("tbody",null,[(i(!0),d(c,null,h(u.teams,e=>(i(),d("tr",{key:e.id},[t("td",null,[t("form",{onSubmit:r(n=>o.updateTeam(n,e.id),["prevent"])},[t("input",{type:"text",placeholder:"Введите название",name:"name",value:e.name},null,8,I)],40,E)]),t("td",{onDragover:a[0]||(a[0]=r(()=>{},["prevent"])),onDrop:n=>o.handleDrop(n,e.id)},[(i(!0),d(c,null,h(u.girls.filter(n=>n.team_id===e.id),n=>(i(),d("div",{class:"team__member",key:n.id},[t("span",null,_(n.name),1),t("button",{class:"delete-btn",onClick:m=>o.removeFromTeam(n.id)},"x",8,x)]))),128))],40,N),t("td",null,[t("form",{onSubmit:r(n=>o.updateTeam(n,e.id),["prevent"])},[t("input",{class:"input__number",type:"number",placeholder:"0",name:"round_1",value:e.round_1},null,8,M)],40,A)]),t("td",null,[t("form",{onSubmit:r(n=>o.updateTeam(n,e.id),["prevent"])},[t("input",{class:"input__number",type:"number",placeholder:"0",name:"round_2",value:e.round_2},null,8,O)],40,F)]),t("td",null,[t("form",{onSubmit:r(n=>o.updateTeam(n,e.id),["prevent"])},[t("input",{class:"input__number",type:"number",placeholder:"0",name:"round_3",value:e.round_3},null,8,Q)],40,P)]),t("td",null,[t("form",{onSubmit:r(n=>o.updateTeam(n,e.id),["prevent"])},[t("input",{class:"input__number",type:"number",placeholder:"0",name:"round_4",value:e.round_4},null,8,L)],40,G)]),t("td",null,[t("form",{onSubmit:r(n=>o.updateTeam(n,e.id),["prevent"])},[t("input",{class:"input__number",type:"number",placeholder:"0",name:"round_5",value:e.round_5},null,8,X)],40,W)]),t("td",null,[t("button",{class:"delete-btn",onClick:n=>o.deleteTeam(e.id)},"Удалить",8,Z)])]))),128)),t("tr",null,[t("td",null,[t("form",{onSubmit:a[2]||(a[2]=r((...e)=>o.addTeam&&o.addTeam(...e),["prevent"]))},[b(t("input",{type:"text",placeholder:"Введите название","onUpdate:modelValue":a[1]||(a[1]=e=>u.teamName=e)},null,512),[[g,u.teamName]])],32)]),B,H,J,U,V,j,R])])])])])])}const K=p(v,[["render",$]]);export{K as default};
